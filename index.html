<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" href="./css/bootstrap.min.css">
        <script src="./js/bootstrap.min.js"></script>
        <script src="./js/avalon.js"></script>
        <script src="./js/mathformat.js"></script>
    </head>
    <body>
    	<div class="container">
    		<div class="col-md-4">
				<div class="jumbotron">
				  <h2>关于小工具</h2>
				  <p>简单小工具，完成地形图的图幅查找以及转换工作	</p>
				  <p>完全线上版本，不用下载不用安装</p>
				  <p>功能不断完善，继续更新</p>
				  <p><img src="./img/logo.jpg" alt="头像" class="img-circle" style="max-width:140px;"></p>
				  <p><a class="btn btn-primary btn-lg" href="#" role="button">项目 Git 地址</a></p>
				</div>
    		</div>
    		<div class="col-md-6">
		        <div ms-controller="box1" class="row">
			        <div class="panel panel-primary">
						<div class="panel-heading">一、根据图幅号求经纬范围</div>
						<div class="panel-body">
							<div class="form-group">
					        	<div class="col-sm-10">
					            	<input type="text" ms-duplex="string" class="form-control" placeholder="例如：J50C003001">
					            </div>
					            <input type="button" value="提交" ms-click="click" class="btn btn-success">
								<div class="alert alert-warning alert-dismissible" role="alert" style="margin-top:20px">
								  <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
								  <strong>注意!</strong> 标准分幅带号不能低于30
								</div>
					            <table class="table table-hover">
					            	<tr>
							            <td>比例尺：{{ style }}</td>
							            <td>带号：{{ daihao }}</td>
							        </tr>
							        <tr>
							        	<td>经差：{{ differLat }}</td>
							        	<td>纬差：{{ differLeng }}</td>
							        </tr>
							        <tr>
							            <td>纬度范围：{{ lat.pre }} - {{ lat.next }}</td>
							            <td>经度范围：{{ leng.pre }} - {{ leng.next }}</td>
						            </tr>
					            </table>
				            </div>
				        </div>
				    </div>
		        </div>

		        <div ms-controller="box2" class="row">
			        <div class="panel panel-primary">
						<div class="panel-heading">二、根据经度得出带号</div>
						<div class="panel-body">
							<div class="form-group">
					        	<div class="col-sm-10">
		        					<input type="text" ms-duplex="string2" class="form-control" placeholder="例如：120.5">
		        				</div>
		        				<input type="button" value="提交" ms-click="click2" class="btn btn-success">
		        				<p>带号：{{ daihao }}</p>
		        			</div>
		        		</div>
		        	</div>
		        </div>

		        <div ms-controller="box3" class="row">
			        <div class="panel panel-primary">
			        	<div class="panel-heading">三、度数转换</div>
						<div class="panel-body">
							<div class="form-group">
					        	<div class="col-sm-10">
		        					<input type="text" ms-duplex="string3" class="form-control" placeholder="例如：120.5">
		        				</div>
					        	<input type="button" value="转换" ms-click="click3" class="btn btn-success">
					        	<p>结果：{{ dushu }}</p>
					        </div>
					    </div>
					</div>
		        </div>
	        </div>
        </div>
        <script>
            avalon.define("box1", function(vm) {
                /* 初始化表单 */
                vm.string = "";
                vm.lat = {
                    pre : "",
                    next : ""
                };
                vm.leng = {
                    pre : "",
                    next : ""
                };
                vm.daihao = "";
                vm.differLat = "";
                vm.differLeng = "";
                vm.style = "";
                vm.click = function() {
                    /* 截取字符串，获得各个位的数字 */
                    first = vm.string.substring (0,1);
                    second = vm.string.substring (1,3);
                    three = vm.string.substring (3,4);
                    four = parseInt(vm.string.substring(4,7));
                    five = parseInt(vm.string.substring(7,10));

                    /* 对字母进行格式化 */
                    first = mathFormat(first);
                    three = mathFormat(three);

                    /* 计算经纬度范围 */
                    vm.lat.pre = (first-1)*4;
                    vm.lat.next = first*4;
                    vm.differLat = vm.lat.next - vm.lat.pre;
                    vm.leng.pre = (second-31)*6;
                    vm.leng.next = (second-30)*6;
                    vm.differLeng = vm.leng.next - vm.leng.pre;
                    vm.daihao = vm.leng.next/6;

                    /* 精度范围的获取 */
                    accuracyLat = getNetNum(three);

                    /* 比例尺获取 */
                    vm.style = getStyle(three);

                    /* 将度数转化成分 */
                    differLatFen = vm.differLat*60;
                    differLengFen = vm.differLeng*60;

                    eachLat = differLatFen/accuracyLat;
                    eachLeng = differLengFen/accuracyLat;

                    x1 = vm.lat.next*60-(four-1)*eachLat;
                    x2 = vm.lat.next*60-four*eachLat;

                    y1 = vm.leng.pre*60+(five-1)*eachLeng;
                    y2 = vm.leng.pre*60+five*eachLeng;

                    /* 格式化页面输出 */
                    vm.lat.pre = changeNum(x2);
                    vm.lat.next = changeNum(x1);
                    vm.differLat = changeNum(eachLat);
                    vm.differLeng = changeNum(eachLeng);
                    vm.leng.pre = changeNum(y1);
                    vm.leng.next = changeNum(y2);
                }
            });
			avalon.define("box2",function(vm){
				vm.string2 = "";
				vm.daihao = "";
				vm.click2 = function(){
					vm.daihao = parseInt(vm.string2/6)+1;
				}
			});
			avalon.define("box3",function(vm){
				vm.string3 = "";
				vm.dushu = "";
				vm.click3 = function(){
					vm.dushu = changeNum(vm.string3*60);
				}
			});
        </script>
    </body>
</html>